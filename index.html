<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcolatore Rendimenti Fondo Pensione</title>
    <link rel="icon" href="./favicon.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="vintage-decoration"></div>
    
    <div class="beta-notification">
        <i class="fas fa-exclamation-triangle"></i>
        Questo calcolatore è in fase BETA. I calcoli potrebbero non essere esatti.
    </div>
    
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div>Parametri di Calcolo</div>
            <button class="close-sidebar" id="close-sidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="sidebar-content">
            <form id="input-form">
                <!-- Parametri Principali -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-sliders-h"></i>
                            Parametri Principali
                        </div>
                        <i class="fas fa-chevron-down section-icon"></i>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label for="durata">Durata (anni)
                                <span class="tooltip">
                                    <span class="tooltip-icon">?</span>
                                    <span class="tooltip-text">
                                        <div class="tooltip-title">Durata</div>
                                        La durata dell'investimento. È consigliata una durata minima di 10 anni per
                                        massimizzare i benefici di entrambi gli strumenti. Investimenti a lungo termine tendono a ridurre il
                                        rischio e aumentare i rendimenti.
                                    </span>
                                </span>
                            </label>
                            <input type="number" id="durata" class="form-control" value="30" min="1" max="50">
                        </div>

                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="reddito">Reddito Annuale (€)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Reddito Annuale</div>
                                                Indicare il reddito deducibile al momento dell'inizio dell'investimento.
                                                Questo dato viene utilizzato per calcolare il TFR, le deduzioni fiscali e il contributo del datore di lavoro.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="reddito" class="form-control" value="30000" min="0" step="1000">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="investimento">Investimento (€)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Investimento Iniziale</div>
                                                La cifra investita annualmente all'inizio dell'investimento.
                                                Un investimento iniziale maggiore può portare a rendimenti più elevati nel lungo termine.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="investimento" class="form-control" value="3000" min="0" step="100">
                                </div>
                            </div>
                        </div>

                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="tfr">Destinazione TFR
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Investire TFR</div>
                                                Indicare se è presente il TFR e se viene lasciato in azienda o portato nel
                                                Fondo Pensione. Lasciare il TFR in azienda può essere meno vantaggioso rispetto a investirlo in un
                                                fondo pensione, che può offrire rendimenti più elevati nel lungo termine.
                                            </span>
                                        </span>
                                    </label>
                                    <select id="tfr" class="form-control">
                                        <option value="Azienda">Azienda</option>
                                        <option value="Fondo Pensione">Fondo Pensione</option>
                                        <option value="Nessuno">Nessuno</option>
                                    </select>
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="contribuzioneDatoreFpPerc">Contributo Datore (%)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Contributo del Datore di Lavoro</div>
                                                In alcuni casi, il datore di lavoro contribuisce
                                                al fondo pensione con una percentuale del reddito del lavoratore. È necessario specificare se questo
                                                contributo è presente. Questo contributo può aumentare significativamente il montante finale del
                                                fondo pensione.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="contribuzioneDatoreFpPerc" class="form-control" value="1.5" min="0" max="100" step="0.1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rendimenti e Inflazione -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-chart-line"></i>
                            Rendimenti e Inflazione
                        </div>
                        <i class="fas fa-chevron-down section-icon"></i>
                    </div>
                    <div class="section-content">
                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="inflazione">Inflazione (%)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Inflazione</div>
                                                L'inflazione media attesa nel periodo indicato. Si consiglia di
                                                lasciare il valore al 2%, target delle Banche Centrali.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="inflazione" class="form-control" value="2" min="0" max="20" step="0.1">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="rendimentoAnnualeFpPerc">Rendimento FP (%)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Rendimento Annuo Storico del Fondo Pensione</div>
                                                Recuperabile dalle tabelle fornite dalla COVIP (Commissione di Vigilanza sui Fondi Pensione). Questo rendimento è da intendersi al netto della tassazione sulle plusvalenze, come per i rendimenti indicati dalla COVIP.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="rendimentoAnnualeFpPerc" class="form-control" value="5" min="0" max="20" step="0.1">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="rendimentoAnnualePacPerc">Rendimento PAC (%)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Rendimento Annuo PAC</div>
                                                Si può utilizzare come benchmark l'indice <em>MSCI All World Index</em>, che ha ottenuto un rendimento medio annuo dell'8,23% negli ultimi 30 anni. Tuttavia, il rendimento può variare molto in base alla strategia di investimento scelta e non è in alcun modo garantito.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="rendimentoAnnualePacPerc" class="form-control" value="7" min="0" max="20" step="0.1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aumento Reddito -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-arrow-trend-up"></i>
                            Aumento Reddito
                        </div>
                        <i class="fas fa-chevron-down section-icon"></i>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>Variazione del Reddito
                                <span class="tooltip">
                                    <span class="tooltip-icon">?</span>
                                    <span class="tooltip-text">
                                        <div class="tooltip-title">Variazione del Reddito</div>
                                        Scegliere tra variazione percentuale o numerica del reddito, specificando la frequenza in anni con cui la variazione avviene e il valore della variazione.
                                    </span>
                                </span>
                            </label>
                            <div class="radio-group">
                                <label>
                                    <input type="radio" name="tipoAumentoReddito" id="tipoAumentoRedditoPerc" value="%" checked>
                                    Percentuale (%)
                                </label>
                                <label>
                                    <input type="radio" name="tipoAumentoReddito" id="tipoAumentoRedditoN" value="€">
                                    Valore (€)
                                </label>
                            </div>
                        </div>
                        
                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="aumentoReddito">Importo</label>
                                    <input type="number" id="aumentoReddito" class="form-control" value="10" min="0" step="0.1">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="freqAumentoReddito">Frequenza (anni)</label>
                                    <input type="number" id="freqAumentoReddito" class="form-control" value="3" min="1" step="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aumento Investimento -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-coins"></i>
                            Aumento Investimento
                        </div>
                        <i class="fas fa-chevron-down section-icon"></i>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>Variazione dell'Investimento
                                <span class="tooltip">
                                    <span class="tooltip-icon">?</span>
                                    <span class="tooltip-text">
                                        <div class="tooltip-title">Variazione dell'Investimento</div>
                                        Scegliere tra variazione percentuale o numerica dell'investimento, specificando la frequenza in anni con cui la variazione avviene e il valore della variazione.
                                    </span>
                                </span>
                            </label>
                            <div class="radio-group">
                                <label>
                                    <input type="radio" name="tipoAumentoInvestimento" id="tipoAumentoInvestimentoPerc" value="%" checked>
                                    Percentuale (%)
                                </label>
                                <label>
                                    <input type="radio" name="tipoAumentoInvestimento" id="tipoAumentoInvestimentoN" value="€">
                                    Valore (€)
                                </label>
                            </div>
                        </div>
                        
                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="aumentoInvestimento">Importo</label>
                                    <input type="number" id="aumentoInvestimento" class="form-control" value="10" min="0" step="0.1">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="freqAumentoInvestimento">Frequenza (anni)</label>
                                    <input type="number" id="freqAumentoInvestimento" class="form-control" value="5" min="1" step="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Opzioni aggiuntive -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-cog"></i>
                            Opzioni Aggiuntive
                        </div>
                        <i class="fas fa-chevron-down section-icon"></i>
                    </div>
                    <div class="section-content">
                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="quotaMinAderentePerc">Quota Aderente (%)
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Quota Minima Aderente</div>
                                                La quota minima che l'aderente deve versare al fondo pensione per poter beneficiare del contributo del datore di lavoro. Nota: al momento non è parametrizzata. In tutte le strategie in cui si investe in FP fino a saturazione viene sempre considerata raggiunta la quota minima aderente.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="quotaMinAderentePerc" class="form-control" value="1" min="0" max="100" step="0.1">
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="frequenzaDiCarico">Frequenza di Carico
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Frequenza di Carico</div>
                                                La frequenza con cui vengono effettuati i versamenti influisce sul calcolo dei rendimenti. Se mensile (viene considerato effettuato l'ultimo giorno del mese) viene moltiplicato per una frazione del tasso annuale. Se annuale, il versamento viene considerato effettuato il 31 dicembre, senza interessi per quell'anno.
                                            </span>
                                        </span>
                                    </label>
                                    <input type="number" id="frequenzaDiCarico" class="form-control" value="0.5" min="0" max="1" step="0.1">
                                </div>
                            </div>
                        </div>

                        <div class="input-row">
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="quotaEccedente">Quota Eccedente
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Modalità di Carico</div>
                                                Le quote volontarie versate tramite bonifico a favore del proprio Fondo Pensione beneficeranno del rimborso fiscale relativo all'IRPEF, ma non consentono di ottenere il rimborso dovuto alle maggiori detrazioni spettanti ai dipendenti. Se invece i versamenti avvengono in busta paga il reddito imponibile ai fini delle detrazioni viene decurtato di tali versamenti.
                                            </span>
                                        </span>
                                    </label>
                                    <select id="quotaEccedente" class="form-control">
                                        <option value="Bonifico">Bonifico</option>
                                        <option value="Busta Paga">Busta Paga</option>
                                    </select>
                                </div>
                            </div>
                            <div class="input-col">
                                <div class="form-group">
                                    <label for="investireRisparmioFisc">Risparmio Fiscale
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-text">
                                                <div class="tooltip-title">Investire Risparmio Fiscale</div>
                                                Indicare se si desidera reinvestire il risparmio fiscale ottenuto dalle deduzioni. Si può scegliere di investirlo nello stesso anno in cui la deduzione viene generata o nell'anno successivo. Il risparmio fiscale investito genera a sua volta altro risparmio fiscale. Se non si hanno problemi di liquidità, si consiglia di selezionare "Anno Corrente".
                                            </span>
                                        </span>
                                    </label>
                                    <select id="investireRisparmioFisc" class="form-control">
                                        <option value="Anno corrente">Anno corrente</option>
                                        <option value="Anno successivo">Anno successivo</option>
                                        <option value="Mai">Mai</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <div>
                    <h1>Calcolatore Fondo Pensione</h1>
                    <div class="subheader">Confronta strategie di investimento per il tuo futuro</div>
                </div>
            </div>
        </div>
    </header>

    <div class="page-container">
        <div class="main-content">
            <!-- Tabs per navigare tra sezioni -->
            <div class="tabs">
                <div class="tab active" data-tab="calculator">
                    <i class="fas fa-calculator"></i> Calcolatore
                </div>
                <div class="tab" data-tab="documentation">
                    <i class="fas fa-book"></i> Guida e Informazioni
                </div>
                <div class="tab" data-tab="technical">
                    <i class="fas fa-code"></i> Logica di Calcolo
                </div>
            </div>

            <!-- Sezione Calcolatore -->
            <div class="tab-content active" id="calculator-content">
                <!-- Action buttons and quick controls -->
                <div class="button-container">
                    <button class="toggle-sidebar" id="toggle-sidebar">
                        <i class="fas fa-sliders-h toggle-icon"></i>
                        Modifica Parametri
                    </button>
                    
                    <div class="quick-controls">
                        <div class="quick-control">
                            <label for="quick-durata">Durata:</label>
                            <input type="number" id="quick-durata" class="form-control" value="30" min="1" max="50">
                        </div>
                        <div class="quick-control">
                            <label for="quick-inflazione">Inflazione (%):</label>
                            <input type="number" id="quick-inflazione" class="form-control" value="2" min="0" max="20" step="0.1">
                        </div>
                    </div>
                </div>

                <!-- Tabella Risultati - Invertito ordine con il blocco "Strategia di Investimento Ottimale" -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-table"></i>
                        Risultati della simulazione
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <div id="grid-div">
                                <!-- La tabella verrà inserita qui dal JavaScript -->
                            </div>
                        </div>

                        <div class="action-buttons">
                            <button id="download-csv" class="btn btn-primary">
                                <i class="fas fa-download"></i>
                                Scarica CSV
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Strategia Ottimale - Ora appare dopo la tabella -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-lightbulb"></i>
                        Strategia di Investimento Ottimale
                    </div>
                    <div class="card-body">
                        <div class="strategy-explanation">
                            <span class="badge badge-primary">Analisi</span>
                            <strong>Nota sulla strategia:</strong> Il calcolatore analizza quattro diverse strategie di investimento e indica, anno per anno, quale sarebbe la scelta ottimale tra Fondo Pensione (FP) e Piano di Accumulo Capitale (PAC). La strategia Mix-2 ottimizza dinamicamente i rendimenti, mentre Mix-1 investe nel FP fino al limite di deduzione e poi nel PAC. Le strategie pure FP e PAC permettono di confrontare gli approcci esclusivi.
                        </div>
                        <div id="strategy-div">
                            <div class="loading-dots">
                                <span class="loading-dot"></span>
                                <span class="loading-dot"></span>
                                <span class="loading-dot"></span>
                            </div>
                            Calcolo in corso...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sezione Documentazione - Migliorata -->
            <div class="tab-content" id="documentation-content">
                <div class="docs-nav">
                    <div class="docs-nav-title">Indice dei Contenuti</div>
                    <ul>
                        <li><a href="#introduction">Introduzione</a></li>
                        <li><a href="#parameters">Parametri di Configurazione</a></li>
                        <li><a href="#strategies">Strategie di Investimento</a></li>
                        <li><a href="#calculations">Calcoli e Tassazione</a></li>
                        <li><a href="#status">Stato del Progetto</a></li>
                    </ul>
                </div>

                <div class="docs-section">
                    <h2 id="introduction">Introduzione</h2>
                    <p>Il <strong>Fondo Pensione (FP)</strong> e il <strong>Piano di Accumulo Capitale (PAC)</strong> rappresentano due strumenti di investimento a lungo termine con caratteristiche e vantaggi specifici. Mentre il Fondo Pensione è progettato per costruire un capitale pensionistico integrativo con significativi vantaggi fiscali, il Piano di Accumulo Capitale offre maggiore flessibilità e liquidità, consentendo di accumulare risparmi attraverso versamenti periodici.</p>
                    
                    <p>Questo calcolatore è stato sviluppato per offrire una panoramica dettagliata dei risultati potenziali di entrambi gli strumenti, tenendo conto di molteplici variabili fiscali e finanziarie. L'obiettivo è fornire un confronto oggettivo tra le diverse strategie di investimento, evidenziando vantaggi e svantaggi di ciascuna opzione in base ai parametri specificati dall'utente.</p>
                    
                    <p>Il sistema analizza quattro strategie principali: investimento esclusivo in Fondo Pensione, investimento esclusivo in PAC e due strategie miste che combinano entrambi gli strumenti. Per ciascuna strategia, il calcolatore elabora proiezioni anno per anno, considerando tutti gli aspetti fiscali, i rendimenti attesi e l'impatto dell'inflazione.</p>

                    <h2 id="parameters">Parametri di Configurazione</h2>
                    
                    <h3>Parametri Temporali</h3>
                    <p><strong>Durata dell'investimento</strong>: Definisce l'orizzonte temporale complessivo del piano di investimento. Per sfruttare al meglio i benefici della capitalizzazione composta e dei vantaggi fiscali, si consiglia una durata minima di 10 anni. Gli investimenti a lungo termine tendono a ridurre la volatilità e a massimizzare i rendimenti potenziali.</p>
                    
                    <p><strong>Frequenza di Carico</strong>: Determina la cadenza con cui vengono effettuati i versamenti e influisce significativamente sul calcolo dei rendimenti composti. Per versamenti mensili (rappresentati da valori vicini a 1), il capitale investito beneficia di un maggiore effetto della capitalizzazione composta rispetto ai versamenti annuali (rappresentati da valori vicini a 0).</p>
                    
                    <h3>Parametri Economici</h3>
                    <p><strong>Reddito Annuale</strong>: Il reddito lordo annuale dell'investitore, utilizzato come base per calcolare il TFR, le deduzioni fiscali e il contributo eventuale del datore di lavoro. Questo valore è fondamentale per determinare i limiti di deducibilità fiscale e i potenziali benefici delle strategie di investimento.</p>
                    
                    <p><strong>Variazione del Reddito</strong>: Consente di simulare aumenti periodici del reddito, sia in termini percentuali che in valore assoluto. Questo parametro è importante per rappresentare realisticamente la progressione di carriera e gli adeguamenti salariali durante l'orizzonte temporale dell'investimento.</p>
                    
                    <p><strong>Investimento Iniziale</strong>: Rappresenta l'importo destinato annualmente all'investimento all'inizio del piano. Questo valore può essere incrementato periodicamente in base alla variazione dell'investimento specificata.</p>
                    
                    <p><strong>Variazione dell'Investimento</strong>: Permette di simulare incrementi periodici dell'importo investito, sia in termini percentuali che in valore assoluto, riflettendo la potenziale capacità di risparmio crescente nel tempo.</p>
                    
                    <h3>Parametri Previdenziali</h3>
                    <p><strong>Contributo del Datore di Lavoro</strong>: In molti contratti collettivi, il datore di lavoro contribuisce al fondo pensione con una percentuale del reddito del lavoratore quando quest'ultimo versa almeno la quota minima prevista. Questo contributo rappresenta un vantaggio esclusivo del fondo pensione e può aumentare significativamente il montante finale.</p>
                    
                    <p><strong>Quota Minima Aderente</strong>: Rappresenta la percentuale minima di contribuzione richiesta al lavoratore per poter beneficiare del contributo datoriale. Il valore specifico dipende dal contratto collettivo applicato.</p>
                    
                    <p><strong>Modalità di Carico</strong>: Specifica se i versamenti volontari al Fondo Pensione avvengono tramite bonifico diretto o trattenuta in busta paga. La modalità scelta influisce sul calcolo delle detrazioni fiscali: i versamenti in busta paga riducono il reddito imponibile, generando un vantaggio fiscale immediato attraverso un ricalcolo delle detrazioni.</p>
                    
                    <p><strong>Gestione del Risparmio Fiscale</strong>: Definisce se e quando reinvestire il risparmio fiscale ottenuto dalle deduzioni. Il risparmio può essere reinvestito nello stesso anno (necessitando di liquidità aggiuntiva), nell'anno successivo (dopo il rimborso fiscale) o non essere reinvestito. Il reinvestimento genera ulteriori benefici fiscali e rendimenti composti nel lungo periodo.</p>
                    
                    <p><strong>Destinazione TFR</strong>: Indica se il Trattamento di Fine Rapporto viene lasciato in azienda, versato nel Fondo Pensione o non è presente. Il TFR versato al Fondo Pensione beneficia potenzialmente di rendimenti più elevati rispetto alla rivalutazione garantita in azienda.</p>
                    
                    <h3>Parametri Finanziari</h3>
                    <p><strong>Inflazione</strong>: Rappresenta il tasso medio di inflazione atteso nel periodo di investimento. L'inflazione erode il potere d'acquisto del capitale nel tempo, quindi è fondamentale considerarla per valutare i rendimenti reali. Il valore di riferimento consigliato è il 2%, target delle principali Banche Centrali.</p>
                    
                    <p><strong>Rendimento Annuo del Fondo Pensione</strong>: Il rendimento medio atteso per il Fondo Pensione, basato sui dati storici forniti dalla COVIP (Commissione di Vigilanza sui Fondi Pensione). Questo rendimento è già al netto della tassazione sulle plusvalenze.</p>
                    
                    <p><strong>Rendimento Annuo del PAC</strong>: Il rendimento medio atteso per il Piano di Accumulo Capitale. Come riferimento, si può considerare l'indice <em>MSCI All World Index</em>, che ha registrato un rendimento medio annuo dell'8,23% negli ultimi 30 anni. Il rendimento effettivo dipenderà dalla composizione del portafoglio e dalla strategia di investimento scelta.</p>

                    <h2 id="strategies">Strategie di Investimento</h2>
                    
                    <h3>Considerazioni sul TFR</h3>
                    <p>In tutte le strategie analizzate, il TFR viene allocato secondo la scelta effettuata dall'utente (azienda o Fondo Pensione). I risultati finali di ciascuna strategia includono anche i rendimenti generati dal TFR nella destinazione selezionata, garantendo un confronto equo tra le diverse opzioni.</p>
                    
                    <h3>Strategia Solo Fondo Pensione</h3>
                    <p>Questa strategia prevede l'investimento esclusivo nel Fondo Pensione, sfruttando al massimo i vantaggi fiscali e il contributo del datore di lavoro. L'intero importo disponibile viene destinato al Fondo Pensione, anche oltre il limite di deducibilità fiscale di 5.164,57 euro. I principali vantaggi includono:</p>
                    <ul>
                        <li>Deduzione fiscale completa sui versamenti entro il limite annuo</li>
                        <li>Contribuzione aggiuntiva del datore di lavoro</li>
                        <li>Tassazione agevolata sui rendimenti (20% invece del 26% del PAC)</li>
                        <li>Tassazione agevolata in fase di erogazione (dal 15% al 9%)</li>
                    </ul>
                    <p>Lo svantaggio principale è la minore liquidità, poiché il capitale è vincolato fino all'età pensionabile, salvo specifiche casistiche di riscatto anticipato.</p>
                    
                    <h3>Strategia Solo PAC</h3>
                    <p>Questa strategia destina l'intero investimento al Piano di Accumulo Capitale, rinunciando ai vantaggi fiscali del Fondo Pensione ma beneficiando di maggiore flessibilità e controllo. I principali vantaggi includono:</p>
                    <ul>
                        <li>Completa libertà di accesso al capitale in qualsiasi momento</li>
                        <li>Maggiore controllo sulla strategia d'investimento</li>
                        <li>Possibilità di diversificazione più ampia</li>
                        <li>Nessun vincolo temporale o di destinazione</li>
                    </ul>
                    <p>Gli svantaggi principali sono la mancanza di deducibilità fiscale sui versamenti, l'assenza del contributo datoriale e la tassazione piena sui rendimenti (26%).</p>
                    
                    <h3>Strategia Mix-1 (Ottimizzazione Fiscale)</h3>
                    <p>Questa strategia combina i vantaggi di entrambi gli strumenti: investe nel Fondo Pensione fino al limite massimo delle deduzioni fiscali (5.164,57 euro), mentre l'eventuale eccedenza viene destinata al PAC. In questo modo:</p>
                    <ul>
                        <li>Si massimizzano i benefici fiscali del Fondo Pensione</li>
                        <li>Si ottiene il contributo del datore di lavoro</li>
                        <li>Si mantiene una componente liquida nell'investimento tramite il PAC</li>
                        <li>Si diversifica il rischio tra due strumenti con regimi fiscali differenti</li>
                    </ul>
                    <p>Questa strategia è particolarmente indicata per chi desidera bilanciare i vantaggi fiscali con una maggiore flessibilità di accesso al capitale.</p>
                    
                    <h3>Strategia Mix-2 (Ottimizzazione Dinamica)</h3>
                    <p>Questa è la strategia più sofisticata: ogni anno viene calcolato se l'interesse composto generato dal Fondo Pensione sulla quota d'investimento entro il limite di deduzione, sommato ai benefici fiscali e al contributo del datore di lavoro, superi l'interesse composto ottenibile investendo la stessa somma nel PAC. L'allocazione viene quindi determinata dinamicamente in base al rendimento atteso maggiore.</p>
                    <p>Per garantire comunque i benefici fiscali in uscita, viene sempre effettuato un investimento minimo simbolico nel Fondo Pensione (1 euro), che permette di mantenere attiva la posizione e beneficiare della tassazione agevolata al momento del riscatto.</p>
                    <p>Questa strategia mira a massimizzare il rendimento complessivo adattandosi alle condizioni specifiche di ciascun anno di investimento.</p>

                    <h2 id="calculations">Calcoli e Tassazione</h2>
                    
                    <h3>Temporalità e Riferimenti</h3>
                    <p>Nella simulazione, l'anno 0 non viene rappresentato nella tabella poiché considerato esclusivamente come anno iniziale di carico. Assumendo il 2024 come anno di partenza e una frequenza di carico annuale, il primo versamento è ipotizzato al 31-12-2024, e la riga 30 nella tabella corrisponderà alla situazione dell'investimento al 31 dicembre 2054.</p>
                    
                    <h3>Tassazione del Fondo Pensione</h3>
                    <p><strong>Tassazione dei versamenti</strong>: I versamenti al Fondo Pensione godono di deducibilità fiscale fino a 5.164,57 euro annui. Questo significa che tali importi vengono sottratti dal reddito imponibile, generando un risparmio fiscale immediato pari all'aliquota marginale IRPEF applicabile. La tassazione è posticipata al momento dell'erogazione.</p>
                    
                    <p><strong>Tassazione delle plusvalenze</strong>: I rendimenti generati dal Fondo Pensione sono tassati annualmente con un'aliquota del 20%, ridotta al 12,5% per la quota derivante da titoli di Stato. Questa tassazione è già applicata dai fondi stessi e i rendimenti riportati dalla COVIP sono già al netto di queste imposte.</p>
                    
                    <p><strong>Tassazione in fase di erogazione</strong>: Al momento del pensionamento o del riscatto, il capitale accumulato viene tassato con un'aliquota agevolata del 15%, ulteriormente riducibile fino al 9% dopo 35 anni di partecipazione al fondo (riduzione dello 0,3% per ogni anno oltre il quindicesimo). La tassazione si applica solo sulla parte non già tassata, escludendo quindi i rendimenti già soggetti a imposta annuale.</p>
                    
                    <h3>Tassazione del PAC</h3>
                    <p><strong>Tassazione dei versamenti</strong>: I versamenti in un Piano di Accumulo Capitale sono effettuati con capitale già tassato, quindi non godono di alcun beneficio fiscale in fase di versamento.</p>
                    
                    <p><strong>Tassazione delle plusvalenze</strong>: Le plusvalenze realizzate con un PAC sono soggette a un'imposta sostitutiva del 26%, ridotta al 12,5% per i titoli di Stato. La tassazione avviene solo al momento del realizzo (vendita).</p>
                    
                    <h3>Trattamento del TFR</h3>
                    <p><strong>Rivalutazione del TFR in azienda</strong>: Il TFR lasciato in azienda viene rivalutato annualmente in base a un tasso fisso dell'1,5% più il 75% dell'inflazione (calcolata sull'indice ISTAT dei prezzi al consumo). Questa rivalutazione è soggetta a un'imposta sostitutiva del 17%.</p>
                    
                    <p><strong>Tassazione del TFR in azienda</strong>: Al momento della liquidazione, il TFR è soggetto a tassazione separata, con aliquota calcolata in base al reddito di riferimento ([TFR totale] × 12 ÷ [anni di servizio]) e alle aliquote IRPEF vigenti.</p>
                    
                    <p><strong>TFR nel Fondo Pensione</strong>: Se versato al Fondo Pensione, il TFR beneficia dello stesso regime fiscale degli altri versamenti, con tassazione agevolata in fase di erogazione.</p>
                    
                    <h3>Componente Assicurativa e Rendita</h3>
                    <p>Il Fondo Pensione include una componente assicurativa che garantisce, al raggiungimento dei requisiti pensionistici, la possibilità di convertire il capitale accumulato in una rendita vitalizia. Questa componente assicurativa rappresenta un ulteriore vantaggio rispetto al PAC, specialmente per chi desidera un'integrazione pensionistica garantita per tutta la vita.</p>

                    <h2 id="status">Stato del Progetto</h2>
                    <p><strong>Limitazioni attuali e sviluppi futuri:</strong></p>
                    <ul>
                        <li><strong>Fase Beta</strong>: Il calcolatore è attualmente in fase di sviluppo beta, quindi l'accuratezza dei calcoli non può essere pienamente garantita.</li>
                        <li><strong>Quota Minima Aderente</strong>: Nelle strategie che prevedono investimenti nel Fondo Pensione fino a saturazione, il calcolatore assume automaticamente che la quota minima aderente sia raggiunta, garantendo così il contributo datoriale. Una futura implementazione permetterà una gestione più precisa di questo parametro.</li>
                        <li><strong>Gestione separata delle quote</strong>: È in fase di sviluppo la gestione separata della quota minima aderente e della quota volontaria nel caso di versamenti via bonifico.</li>
                        <li><strong>Ottimizzazione del risparmio fiscale</strong>: È prevista l'implementazione di un calcolo ricorsivo del risparmio fiscale ottimale, considerando i benefici fiscali generati dal reinvestimento.</li>
                        <li><strong>Addizionali regionali e comunali</strong>: Attualmente il calcolatore simula l'effetto delle addizionali aumentando le aliquote IRPEF. Una futura implementazione includerà un calcolo preciso delle addizionali regionali e comunali.</li>
                        <li><strong>Reddito variabile</strong>: È prevista l'implementazione di un modulo per gestire scenari con reddito variabile o non continuativo.</li>
                        <li><strong>Trasferibilità del TFR</strong>: È in fase di sviluppo una funzionalità per simulare il trasferimento del TFR accumulato tra diversi strumenti in caso di cambio lavorativo.</li>
                    </ul>
                    <p>Per qualsiasi feedback, segnalazione o suggerimento, puoi contattare lo sviluppatore all'indirizzo pippo995@gmail.com</p>
                </div>
            </div>

            <!-- NUOVA Sezione: Logica di Calcolo -->
            <div class="tab-content" id="technical-content">
                <div class="docs-nav">
                    <div class="docs-nav-title">Indice Tecnico</div>
                    <ul>
                        <li><a href="#calc-overview">Panoramica delle Formule</a></li>
                        <li><a href="#calc-model">Modello Finanziario</a></li>
                        <li><a href="#calc-strategies">Implementazione Strategie</a></li>
                        <li><a href="#calc-tax">Calcolo Fiscale</a></li>
                        <li><a href="#calc-optimization">Ottimizzazione</a></li>
                    </ul>
                </div>

                <div class="docs-section">
                    <h2 id="calc-overview">Panoramica delle Formule di Calcolo</h2>
                    <p>Il calcolatore utilizza un modello matematico complesso che simula l'evoluzione degli investimenti in un arco temporale definito dall'utente. La logica si basa sulla classe <code>FinancialModel</code> che implementa tutti i calcoli necessari per stimare i rendimenti delle diverse strategie di investimento.</p>

                    <h3>Formule Principali</h3>
                    <div class="formula-container">
                        <p><strong>Calcolo del TFR annuale:</strong></p>
                        <pre>TFR = Reddito × 0.06907</pre>
                        
                        <p><strong>Rivalutazione TFR in azienda:</strong></p>
                        <pre>TFR Montante(anno) = TFR Montante(anno-1) × (1 + (Inflazione × 0.75 + 0.015) × 0.83) + TFR(anno)</pre>
                        
                        <p><strong>Rivalutazione TFR nel Fondo Pensione:</strong></p>
                        <pre>TFR FP Montante(anno) = TFR FP Montante(anno-1) × (1 + Rendimento FP) + TFR(anno) × (1 + Rendimento FP × Frequenza Carico)</pre>
                        
                        <p><strong>Calcolo dell'accumulo nel Fondo Pensione:</strong></p>
                        <pre>FP Montante(anno) = FP Montante(anno-1) × (1 + Rendimento FP) + Investimento FP × (1 + Rendimento FP × Frequenza Carico)</pre>
                        
                        <p><strong>Calcolo dell'accumulo nel PAC:</strong></p>
                        <pre>PAC Montante(anno) = PAC Montante(anno-1) × (1 + Rendimento PAC) + Investimento PAC × (1 + Rendimento PAC × Frequenza Carico)</pre>
                    </div>

                    <h2 id="calc-model">Modello Finanziario</h2>
                    <p>Il modello finanziario si basa su un'iterazione annuale che aggiorna progressivamente i valori economici dell'investimento. Per ogni anno del periodo di investimento, il sistema:</p>

                    <ol>
                        <li><strong>Aggiorna il reddito e l'investimento</strong> in base ai tassi di crescita configurati</li>
                        <li><strong>Calcola il TFR</strong> come frazione del reddito (6,907%)</li>
                        <li><strong>Determina le deduzioni fiscali</strong> disponibili considerando il limite legale (5.164,57€) e il contributo datoriale</li>
                        <li><strong>Calcola il risparmio fiscale</strong> generato dagli investimenti nel Fondo Pensione</li>
                        <li><strong>Simula l'andamento delle quattro strategie</strong> di investimento</li>
                        <li><strong>Registra i risultati annuali</strong> di ciascuna strategia</li>
                    </ol>

                    <p>Per l'aggiornamento periodico dei valori (reddito e investimento), il modello utilizza la seguente formula:</p>

                    <pre>
Se (Anno > 0 E Anno % Frequenza == 0) {
    Se (Tipo == "%") {
        Valore = Valore Precedente + (Valore Precedente × Percentuale / 100)
    } Altrimenti {
        Valore = Valore Precedente + Incremento Assoluto
    }
}
                    </pre>

                    <h2 id="calc-strategies">Implementazione delle Strategie</h2>

                    <h3>Strategia Solo Fondo Pensione</h3>
                    <p>Questa strategia investe l'intero importo disponibile (investimento + risparmio fiscale + contributo datoriale) nel Fondo Pensione. L'accumulazione segue la formula dell'interesse composto con capitalizzazione annuale, considerando anche la frequenza di carico per i nuovi versamenti:</p>

                    <pre>
FP Versamenti += Investimento + Risparmio Fiscale + Contributo Datoriale
FP Montante = FP Montante × (1 + Rendimento FP) + 
              (Investimento + Risparmio Fiscale + Contributo Datoriale) × (1 + Rendimento FP × Frequenza Carico)
                    </pre>

                    <p>Il valore di uscita (Exit) tiene conto della tassazione agevolata:</p>

                    <pre>
FP Exit = FP Montante - (FP Versamenti × Tassazione FP) + TFR Exit
                    </pre>

                    <p>Dove la tassazione FP varia dal 15% al 9% in base agli anni di partecipazione.</p>

                    <h3>Strategia Solo PAC</h3>
                    <p>Questa strategia investe solo l'importo base nel Piano di Accumulo Capitale, senza beneficiare del risparmio fiscale o del contributo datoriale:</p>

                    <pre>
PAC Versamenti += Investimento
PAC Montante = PAC Montante × (1 + Rendimento PAC) + 
               Investimento × (1 + Rendimento PAC × Frequenza Carico)
                    </pre>

                    <p>Il valore di uscita considera la tassazione standard del 26% sulle plusvalenze:</p>

                    <pre>
PAC Exit = PAC Montante - ((PAC Montante - PAC Versamenti) × 26%) + TFR Exit
                    </pre>

                    <h3>Strategia Mix-1</h3>
                    <p>La strategia Mix-1 suddivide l'investimento totale tra Fondo Pensione (fino al limite di deduzione) e PAC (per l'eccedenza):</p>

                    <pre>
FP Mix1 Entro Deduzione = min(Investimento Totale, Limite Deduzione)
PAC Mix1 Oltre Deduzione = Investimento Totale - FP Mix1 Entro Deduzione
                    </pre>

                    <p>Le formule di accumulazione seguono lo stesso schema delle strategie pure, ma applicate alle quote rispettive.</p>

                    <h3>Strategia Mix-2</h3>
                    <p>La strategia Mix-2 implementa una logica di ottimizzazione dinamica che confronta i rendimenti composti attesi. Per ogni anno, calcola:</p>

                    <ol>
                        <li>Il rendimento composto atteso se si investe nel Fondo Pensione entro il limite di deduzione</li>
                        <li>Il rendimento composto atteso se si investe nel PAC la stessa somma entro deduzione</li>
                        <li>Il rendimento composto atteso se si investe nel Fondo Pensione oltre il limite di deduzione</li>
                        <li>Il rendimento composto atteso se si investe nel PAC la stessa somma oltre deduzione</li>
                    </ol>

                    <p>Basandosi su questo confronto, determina la migliore allocazione per l'anno corrente, mantenendo sempre almeno 1€ nel Fondo Pensione per preservare i vantaggi fiscali.</p>

                    <h2 id="calc-tax">Calcolo Fiscale</h2>
                    <p>Il modello implementa il sistema fiscale italiano con particolare attenzione alle specificità dei fondi pensione e degli investimenti finanziari:</p>

                    <h3>Calcolo dell'IRPEF</h3>
                    <p>L'imposta sul reddito è calcolata secondo i seguenti scaglioni:</p>
                    <pre>
Se (Reddito ≤ 15.000€):            Imposta = Reddito × 24%
Se (15.000€ < Reddito ≤ 28.000€):  Imposta = 3.600€ + (Reddito - 15.000€) × 26%
Se (28.000€ < Reddito ≤ 50.000€):  Imposta = 6.980€ + (Reddito - 28.000€) × 37% 
Se (Reddito > 50.000€):            Imposta = 15.120€ + (Reddito - 50.000€) × 45%
                    </pre>

                    <h3>Detrazioni per Lavoratori Dipendenti</h3>
                    <p>Le detrazioni sono calcolate in base al reddito:</p>
                    <pre>
Se (Reddito ≤ 15.000€):            Detrazione = 1.880€
Se (15.000€ < Reddito ≤ 28.000€):  Detrazione = 1.910€ + 1.190€ × ((28.000€ - Reddito) / 13.000€)
Se (28.000€ < Reddito ≤ 50.000€):  Detrazione = 1.910€ × ((50.000€ - Reddito) / 22.000€)
Se (Reddito > 50.000€):            Detrazione = 0€

// Bonus aggiuntivo
Se (25.000€ ≤ Reddito ≤ 35.000€):  Detrazione += 65€
                    </pre>

                    <h3>Tassazione Fondi Pensione</h3>
                    <p>La tassazione al momento del riscatto è progressivamente agevolata in base alla durata della partecipazione:</p>
                    <pre>
Aliquota Base = 15%
Riduzione = min((Anni Partecipazione - 15) × 0,3%, 6%)
Aliquota Effettiva = max(Aliquota Base - Riduzione, 9%)
                    </pre>

                    <h3>Calcolo del Risparmio Fiscale</h3>
                    <p>Il risparmio fiscale derivante dalla deduzione dei versamenti al Fondo Pensione è calcolato come:</p>
                    <pre>
Deduzione = min(Investimento, Limite Deduzione Effettivo)
Reddito Dedotto = max(Reddito Imponibile - Deduzione, 0)
Imposta Lorda Dedotta = Calcola Imposta(Reddito Dedotto)
Imposta Netta Dedotta = max(Imposta Lorda Dedotta - Detrazione Dipendente, 0)
Risparmio Fiscale = Imposta Netta Originale - Imposta Netta Dedotta
                    </pre>

                    <h2 id="calc-optimization">Logica di Ottimizzazione</h2>
                    <p>Il cuore dell'ottimizzazione nella strategia Mix-2 è l'analisi comparativa dei rendimenti attesi. Per ogni anno, il sistema calcola:</p>

                    <pre>
// Rendimento composto atteso fino a fine periodo
Rendimento Composto FP = (1 + Rendimento FP Annuale)^(Durata - Anno Corrente - 1)
Rendimento Composto PAC = (1 + Rendimento PAC Annuale)^(Durata - Anno Corrente - 1)

// Interesse composto generato da investimento entro deduzione nel FP
Interesse FP Entro = (Investimento Entro Deduzione × Rendimento Composto FP) + 
                     (Investimento Entro Deduzione × Rendimento FP × Frequenza Carico) -
                     (Investimento Entro Deduzione × Tassazione FP)

// Interesse composto generato da investimento entro deduzione nel PAC
Rendimento PAC Entro = (Investimento Entro Deduzione × Rendimento Composto PAC) + 
                        (Investimento Entro Deduzione × Rendimento PAC × Frequenza Carico)
Interesse PAC Entro = Rendimento PAC Entro - 
                     ((Rendimento PAC Entro - Investimento Entro Deduzione) × Tassazione PAC)
                    </pre>

                    <p>Lo stesso calcolo viene effettuato per gli investimenti oltre il limite di deduzione. Confrontando questi valori, il sistema determina in quale strumento investire per massimizzare il rendimento complessivo, tenendo conto di:</p>

                    <ul>
                        <li>I differenti regimi fiscali (deduzione iniziale per il FP vs tassazione più alta sulle plusvalenze del PAC)</li>
                        <li>Il contributo del datore di lavoro (disponibile solo per il FP)</li>
                        <li>Il risparmio fiscale generato dalla deduzione (che può essere reinvestito)</li>
                        <li>I diversi rendimenti lordi dei due strumenti</li>
                    </ul>

                    <p>La strategia ottimale risultante viene tradotta in semplici indicazioni nella sezione "Strategia di Investimento Ottimale", che specifica, anno per anno, in quale strumento concentrare l'investimento, sia per la quota entro deduzione che per quella eccedente.</p>
                </div>
            </div>
        </div>
    </div>

    <a href="#" class="go-to-top" id="go-to-top">
        <i class="fas fa-arrow-up"></i>
    </a>

    <footer class="footer">
        <p>© 2025 Calcolatore Investimenti Finanziari | I calcoli sono basati su stime e non costituiscono consulenza finanziaria.</p>
    </footer>

    <script src="js/scripts.js"></script>
    <script src="js/app.js" type="module"></script>
</body>
</html>